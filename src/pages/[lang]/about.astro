---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getImage } from "astro:assets";
import Content2 from "@/components/widgets/Content2.astro";
import Values from "@/components/widgets/Values.astro";
import azerothImage from "@/assets/images/about/azeroth.jpg";
import lichkingImage from "@/assets/images/about/lichking.jpg";
import { useTranslations, getLangFromUrl } from "@/i18n";
import { ui, defaultLang } from "@/i18n";

// Export getStaticPaths function
export function getStaticPaths() {
  // Include all languages, including default language
  const languages = Object.keys(ui);
  
  return languages.map(lang => ({
    params: { lang },
    props: { lang },
  }));
}

// Get current language from URL
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const metadata = {
    title: t('about.title'),
    description: t('about.description'),
};

const values = [
    {
        title: t('about.values.mission'),
        description: t('about.values.missionDesc'),
    },
    {
        title: t('about.values.community'),
        description: t('about.values.communityDesc'),
    },
    {
        title: t('about.values.forPlayers'),
        description: t('about.values.forPlayersDesc'),
    },
    {
        title: t('about.values.forCreators'),
        description: t('about.values.forCreatorsDesc'),
    },
    {
        title: t('about.values.vision'),
        description: t('about.values.visionDesc'),
    },
    {
        title: t('about.values.builtByCommunity'),
        description: t('about.values.builtByCommunityDesc'),
    },
];

const optimizedImage = await getImage({
    src: azerothImage,
    format: "webp",
});
---

<BaseLayout {metadata} lang={lang}>
    <link slot="head" rel="preload" href={optimizedImage.src} as="image" />
    <Content2
        title={t('about.title')}
        description={[
            t('about.story.content')
        ]}
        tagline={t('about.story.title')}
        image={azerothImage}
        imageAlt="Azeroth landscape"
        actions={[
            {
                text: t('about.actions.contact'),
                href: `/${lang}/contact`,
                variant: "primary",
                icon: "lucide:mail",
            }
        ]}
    />
    <Values
        items={values}
        columns={3}
        tagline={t('about.values.tagline')}
        title={t('about.values.title')}
        subtitle={t('about.values.subtitle')}
    />
    
    <Content2
        title={t('about.finalWords.title')}
        description={[
            t('about.finalWords.content')
        ]}
        tagline={t('about.finalWords.tagline')}
        image={lichkingImage}
        isReversed={true}
        imageAlt="Lich King"
        
    />
    <!-- <link slot="head" rel="preload" href={optimizedImage.src} as="image" /> -->
</BaseLayout>